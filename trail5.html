<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>3D Cube Level Game</title>
  <style>
    body { margin: 0; overflow: hidden; }
    canvas { display: block; }
    #ui {
      position: absolute;
      top: 20px;
      left: 20px;
      font-family: sans-serif;
      color: white;
      background: rgba(0,0,0,0.5);
      padding: 10px;
      border-radius: 8px;
      z-index: 1;
    }
    #startScreen, #winScreen {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      color: white;
      font-family: sans-serif;
      z-index: 2;
    }
    input[type="text"] {
      padding: 10px;
      font-size: 16px;
      margin-top: 10px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      margin-top: 10px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<!-- Start Screen -->
<div id="startScreen">
  <h1>Welcome to Cube Adventure!</h1>
  <p>Enter your name to start:</p>
  <input type="text" id="playerName" placeholder="Your name" />
  <button onclick="startGame()">Start Game</button>
</div>

<!-- Win Screen -->
<div id="winScreen" style="display: none;">
  <h1>ðŸŽ‰ Congratulations!</h1>
  <p id="winnerName">You finished the game!</p>
  <button onclick="location.reload()">Play Again</button>
</div>

<!-- HUD -->
<div id="ui">Level: 1</div>

<!-- Three.js Game Code -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
  let player = { name: "Player" };
  let currentLevel = 0;

  const levels = [
    { start: { x: 0, z: 0 }, goal: { x: 5, z: 5 } },
    { start: { x: -5, z: 5 }, goal: { x: 5, z: -5 } },
    { start: { x: -10, z: -10 }, goal: { x: 10, z: 10 } },
    { start: { x: 8, z: -8 }, goal: { x: -8, z: 8 } },
    { start: { x: 0, z: 0 }, goal: { x: 0, z: 10 } },
    { start: { x: 5, z: 5 }, goal: { x: -5, z: -5 } },
    { start: { x: -10, z: 0 }, goal: { x: 10, z: 0 } }
  ];

  const message = document.getElementById("ui");
  const startScreen = document.getElementById("startScreen");
  const winScreen = document.getElementById("winScreen");
  const winnerName = document.getElementById("winnerName");

  // Scene setup
  const scene = new THREE.Scene();
  scene.background = new THREE.Color(0xa0a0a0);
  const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
  const renderer = new THREE.WebGLRenderer({ antialias: true });
  renderer.setSize(window.innerWidth, window.innerHeight);
  renderer.shadowMap.enabled = true;
  document.body.appendChild(renderer.domElement);

  const ambientLight = new THREE.AmbientLight(0xffffff, 0.4);
  scene.add(ambientLight);
  const dirLight = new THREE.DirectionalLight(0xffffff, 0.8);
  dirLight.position.set(10, 20, 10);
  dirLight.castShadow = true;
  scene.add(dirLight);

  const ground = new THREE.Mesh(
    new THREE.PlaneGeometry(50, 50),
    new THREE.MeshStandardMaterial({ color: 0x228822 })
  );
  ground.rotation.x = -Math.PI / 2;
  ground.receiveShadow = true;
  scene.add(ground);

  const cube = new THREE.Mesh(
    new THREE.BoxGeometry(1, 1, 1),
    new THREE.MeshStandardMaterial({ color: 0x00ff00 })
  );
  cube.castShadow = true;
  cube.position.y = 0.5;
  scene.add(cube);

  const goal = new THREE.Mesh(
    new THREE.BoxGeometry(1, 1, 1),
    new THREE.MeshStandardMaterial({ color: 0xffff00 })
  );
  goal.castShadow = true;
  goal.position.y = 0.5;
  scene.add(goal);

  camera.position.set(6, 10, 12);
  camera.lookAt(0, 0, 0);

  window.addEventListener("resize", () => {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
  });

  const keys = {};
  document.addEventListener("keydown", e => keys[e.key.toLowerCase()] = true);
  document.addEventListener("keyup", e => keys[e.key.toLowerCase()] = false);

  function moveCube() {
    const speed = 0.1;
    if (keys["w"] || keys["arrowup"]) cube.position.z -= speed;
    if (keys["s"] || keys["arrowdown"]) cube.position.z += speed;
    if (keys["a"] || keys["arrowleft"]) cube.position.x -= speed;
    if (keys["d"] || keys["arrowright"]) cube.position.x += speed;
  }

  function loadLevel(index) {
    const level = levels[index];
    cube.position.set(level.start.x, 0.5, level.start.z);
    goal.position.set(level.goal.x, 0.5, level.goal.z);
    message.textContent = `Level: ${index + 1}`;
  }

  function checkGoal() {
    const dist = cube.position.distanceTo(goal.position);
    if (dist < 1) {
      currentLevel++;
      if (currentLevel >= levels.length) {
        message.style.display = "none";
        winnerName.textContent = `${player.name}, you finished all levels! ðŸŽ‰`;
        winScreen.style.display = "flex";
      } else {
        loadLevel(currentLevel);
      }
    }
  }

  function animate() {
    requestAnimationFrame(animate);
    moveCube();
    checkGoal();
    renderer.render(scene, camera);
  }

  function startGame() {
    const nameInput = document.getElementById("playerName").value.trim();
    player.name = nameInput ? nameInput : "Player";
    startScreen.style.display = "none";
    message.style.display = "block";
    loadLevel(currentLevel);
    animate();
  }
</script>
</body>
</html>
